<!DOCTYPE html> 
<html>
<head>
    <meta charset="UTF-8">
    <meta name="author" content="Ben Bobo">
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="imgs/favicon.png">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="js/openBotsSchedule.js"></script>
    <script src="js/isBusinessDay.js"></script>
    <script src="js/printToScreen.js"></script>
    <script src="js/convertToBusinessDay.js"></script>
    <script src="js/convertDayToMonthEndDay.js"></script>
</head>
<body>
<![if !IE]>
<!-- The Modal #HTML-->
<div id="modal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <div class="container" id="utilization_bar">
        <p class="bot_ut_info">*Bot utilization includes blackout times</p>
        <div class="progress" id="bot_utilized_percent"></div>
    </div>
    <p id="schedule"></p>
    <div id="bot_picture" style="width:100%"></div>
    <div class="reserve_time_wrapper" id="reserve_time_wrapper">
        <p class="time_slot_container">Reserve a time slot:</p>
        <div class="reserve_info">
            <input type="text" placeholder="your name" id="reserve_name" onfocus="this.value=''"></input>
            <input type="text" placeholder="process" id="reserve_process" onfocus="this.value=''"></input>
            <p id="missing_info_error" style="color:red; font-weight:initial;"></p>
        </div>
        <div id="reserve_bot_time"> Reserve Bot Time </div>
        <div id="reserved_times"> </div>
    </div>
    
  </div>
</div>
<div id="mySidebar" class="sidebar">
   <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">Ã—</a>
   <div class="footer_id"></div>
   <div class="footer_title">Business Day?:</div>
   <div class="footer_id" id="biz_day">Yes</div>
   <div class="footer_title">Day of the week:</div>
   <div class="footer_id" id="day"></div>
   <div class="footer_title">Current Hour:</div>
   <div class="footer_id" id="hour"></div>
   <div class="footer_title">Business Day:</div>
   <div class="footer_id" id="businessDay"></div>
   <div class="footer_title">Month End Day:</div>
   <div class="footer_id" id="monthEnd"></div> 
   <a class="found_bug" href="mailto:ben.bobo@cbrands.com?subject=OPENBOTS Bug"> Something Broken? <i style="font-size:18px;" class="material-icons">&#xe0be;</i></a>
   <div class="help">
       <i id="help" class="material-icons">&#xe887;</i>
   </div>
</div>



<!-- The Header #HTML-->
<ul class="nav_bar">
    <li id="main"><div title="More Info" class="openbtn" onclick="openNav()"> <i class="material-icons">&#xe03c;</i></div></li>
    <li class="media_small table-cell">
        <a href="schedules.html" target="_blank" class="header_link">Todays Bot Schedule: 
        <p class="header_todays_date" id="todaysDate"></p></a>
    </li>
    <li class="media_small table-cell"><a class="active">v4.0 - (<strong>all times are EST</strong>)</a></li>
    <li class="header_all_statuses header_change_date table-cell"><a class='active' style='text-decoration:underline !important;' onclick="bot_status_iframe_login('FALSE')">Check All Statuses</a></li>
    <li class="header table-cell"><a class="active"> 
        <div class="material-icons header_change_date refresh_date media_small" onClick="window.location.reload()">&#xe5d5;</div>
        <div class="change_date_title">Change Date:</div>
        <input type="date" id="dateInput" class="header_date_selector">
        <div type="submit" onclick="init(document.getElementById('dateInput').value)" class="material-icons header_change_date">&#xe8b6;</div></a>
    </li>
</ul>

<!--***********************************START BOTS PRINTED SCHEDULES #HTML************************************-->
<center>

    <div><h2 class="bots_server_title">GDC BOTS:</h2></div>
    <!--CBIGDC_PBOTZ901-->
    <div id="GDC_PBOTZ901" class="hover bot_container" title="expand...">
        <p title="CBIGDC_PBOTZ901" id="CBIGDC_PBOTZ901_title" class="bot_title" style="background-color:#FBF974"></p>
        <p id="CBIGDC_PBOTZ901_body"  class="bot_body"></p> 
        <div id="CBIGDC_PBOTZ901_resourceUnit"></div>
        <p id="CBIGDC_PBOTZ901_available" class="bot_available"></p>
        <p id="CBIGDC_PBOTZ901_dupe" class="bot_dupe"></p>
        <button class='btn btn-link btn-xs' onclick="bot_status_iframe_login('http://cbigdc-pbotz901.cbi.net:8181/user%20name%20username@CWC.cbi.net&password%20pwd&status')">Current Status</button>
    </div>
    <!--CBIGDC_PBOTZ902-->
    <div id="GDC_PBOTZ902" class="hover bot_container" title="expand...">
        <p title="CBIGDC_PBOTZ902" id="CBIGDC_PBOTZ902_title" class="bot_title" style="background-color:#fc8a8a"></p>
        <p id="CBIGDC_PBOTZ902_body" class="bot_body"></p>
        <div id="CBIGDC_PBOTZ902_resourceUnit"></div>
        <p id="CBIGDC_PBOTZ902_available" class="bot_available"></p>
        <p id="CBIGDC_PBOTZ902_dupe" class="bot_dupe"></p>
        <button class='btn btn-link btn-xs' onclick="bot_status_iframe_login('http://cbigdc-pbotz902.cbi.net:8181/user%20name%20username@CWC.cbi.net&password%20pwd&status')">Current Status</button>
    </div>
    <!--CBIGDC_PBOTZ903-->
    <div id="GDC_PBOTZ903" class="hover bot_container" title="expand...">
        <p title="CBIGDC_PBOTZ903" id="CBIGDC_PBOTZ903_title" class="bot_title" style="background-color:#79b8e5"></p>
        <p id="CBIGDC_PBOTZ903_body" class="bot_body"></p>
        <div id="CBIGDC_PBOTZ903_resourceUnit"></div>
        <p id="CBIGDC_PBOTZ903_available" class="bot_available"></p>
        <p id="CBIGDC_PBOTZ903_dupe" class="bot_dupe"></p>
        <button class='btn btn-link btn-xs' onclick="bot_status_iframe_login('http://cbigdc-pbotz903.cbi.net:8181/user%20name%20username@CWC.cbi.net&password%20pwd&status')">Current Status</button>
    </div>
    <!--CBIGDC_PBOTZ904-->
    <div id="GDC_PBOTZ904" class="hover bot_container" title="expand...">
        <p title="CBIGDC_PBOTZ904" id="CBIGDC_PBOTZ904_title" class="bot_title" style="background-color:#f4bf7a"></p>
        <p id="CBIGDC_PBOTZ904_body" class="bot_body"></p>
        <div id="CBIGDC_PBOTZ904_resourceUnit"></div>
        <p id="CBIGDC_PBOTZ904_available" class="bot_available"></p>
        <p id="CBIGDC_PBOTZ904_dupe" class="bot_dupe"></p>
        <button class='btn btn-link btn-xs' onclick="bot_status_iframe_login('http://cbigdc-pbotz904.cbi.net:8181/user%20name%20username@CWC.cbi.net&password%20pwd&status')">Current Status</button>
    </div>
    <!--CBIGDC_PBOTZ960-->
    <div id="GDC_PBOTZ960" class="hover bot_container" title="expand...">
        <p title="CBIGDC_PBOTZ960" id="CBIGDC_PBOTZ960_title" class="bot_title" style="background-color:#04d491"></p>
        <p id="CBIGDC_PBOTZ960_body"  class="bot_body"></p> 
        <div id="CBIGDC_PBOTZ960_resourceUnit"></div>
        <p id="CBIGDC_PBOTZ960_available" class="bot_available"></p>
        <p id="CBIGDC_PBOTZ960_dupe" class="bot_dupe"></p>
        <button class='btn btn-link btn-xs' onclick="bot_status_iframe_login('http://cbigdc-pbotz960.cbi.net:8181/user%20name%20username@CWC.cbi.net&password%20pwd&status')">Current Status</button>
    </div><br>
    <div><h2 class="bots_server_title" style="margin-top:40px;">TDC BOTS:</h2></div>
    <!--CBITDC_PBOTZ901-->
    <div id="TDC_PBOTZ901" class="hover bot_container" title="expand...">
        <p title="CBITDC_PBOTZ901" id="CBITDC_PBOTZ901_title" class="bot_title" style="background-color:#abea7e"></p>
        <p id="CBITDC_PBOTZ901_body" class="bot_body"></p>
        <div id="CBITDC_PBOTZ901_resourceUnit"></div>
        <p id="CBITDC_PBOTZ901_available" class="bot_available"></p>
        <p id="CBITDC_PBOTZ901_dupe" class="bot_dupe"></p>
        <button class='btn btn-link btn-xs' onclick="bot_status_iframe_login('http://cbitdc-pbotz901.cbi.net:8181/user%20name%20username@CWC.cbi.net&password%20pwd&status')">Current Status</button>
    </div>
    <!--CBITDC_PBOTZ902-->
    <div id="TDC_PBOTZ902" class="hover bot_container" title="expand...">
        <p title="CBITDC_PBOTZ902" id="CBITDC_PBOTZ902_title" class="bot_title" style="background-color:#85898c"></p>
        <p id="CBITDC_PBOTZ902_body" class="bot_body"></p>
        <div id="CBITDC_PBOTZ902_resourceUnit"></div>
        <p id="CBITDC_PBOTZ902_available" class="bot_available"></p>
        <p id="CBITDC_PBOTZ902_dupe" class="bot_dupe"></p>
        <button class='btn btn-link btn-xs' onclick="bot_status_iframe_login('http://cbitdc-pbotz902.cbi.net:8181/user%20name%20username@CWC.cbi.net&password%20pwd&status')">Current Status</button>
    </div>
    <!--CBITDC_PBOTZ903-->
    <div id="TDC_PBOTZ903" class="hover bot_container" title="expand...">
        <p title="CBITDC_PBOTZ903" id="CBITDC_PBOTZ903_title" class="bot_title" style="background-color:#b8c0c5"></p>
        <p id="CBITDC_PBOTZ903_body" class="bot_body"></p>
        <div id="CBITDC_PBOTZ903_resourceUnit"></div>
        <p id="CBITDC_PBOTZ903_available" class="bot_available"></p>
        <p id="CBITDC_PBOTZ903_dupe" class="bot_dupe"></p>
        <button class='btn btn-link btn-xs' onclick="bot_status_iframe_login('http://cbitdc-pbotz903.cbi.net:8181/user%20name%20username@CWC.cbi.net&password%20pwd&status')">Current Status</button>
    </div>
    <!--CBITDC_PBOTZ904-->
    <div id="TDC_PBOTZ904" class="hover bot_container" title="expand...">
        <p title="CBITDC_PBOTZ904" id="CBITDC_PBOTZ904_title" class="bot_title" style="background-color:#2ad1cc"></p>
        <p id="CBITDC_PBOTZ904_body" class="bot_body"></p> 
        <div id="CBITDC_PBOTZ904_resourceUnit"></div>
        <p id="CBITDC_PBOTZ904_available" class="bot_available"></p>
        <p id="CBITDC_PBOTZ904_dupe" class="bot_dupe"></p>
        <button class='btn btn-link btn-xs' onclick="bot_status_iframe_login('http://cbitdc-pbotz904.cbi.net:8181/user%20name%20username@CWC.cbi.net&password%20pwd&status')">Current Status</button>
    </div>
    <!--CBITDC_PBOTZ960-->
    <div id="TDC_PBOTZ960" class="hover bot_container" title="expand...">
        <p title="CBITDC_PBOTZ960" id="CBITDC_PBOTZ960_title" class="bot_title" style="background-color:rgb(175, 149, 226)"></p>
        <p id="CBITDC_PBOTZ960_body" class="bot_body"></p> 
        <div id="CBITDC_PBOTZ960_resourceUnit"></div>
        <p id="CBITDC_PBOTZ960_available" class="bot_available"></p>
        <p id="CBITDC_PBOTZ960_dupe" class="bot_dupe"></p>
        <button class='btn btn-link btn-xs' onclick="bot_status_iframe_login('http://cbitdc-pbotz960.cbi.net:8181/user%20name%20username@CWC.cbi.net&password%20pwd&status')">Current Status</button>
    </div>
</center>
<!--***********************************END BOTS PRINTED SCHEDULES #HTML************************************-->
<![endif]>



<script>
    var self = this;
    if(self.RESERVE_DATA === undefined){
        getReserveAPI();
    }
    init();
    function init(datePassedIn){
        self.botSched();
        //reset printed schedules 
        self.gdc01_runningToday = "";
        self.gdc02_runningToday = "";
        self.gdc03_runningToday = "";
        self.gdc04_runningToday = "";
        self.gdc05_runningToday = "";
        self.tdc01_runningToday = "";
        self.tdc02_runningToday = "";
        self.tdc03_runningToday = "";
        self.tdc04_runningToday = "";
        self.tdc05_runningToday = "";
        document.getElementById("CBIGDC_PBOTZ901_body").innerHTML = ""
        document.getElementById("CBIGDC_PBOTZ902_body").innerHTML = ""
        document.getElementById("CBIGDC_PBOTZ903_body").innerHTML = ""
        document.getElementById("CBIGDC_PBOTZ904_body").innerHTML = ""
        document.getElementById("CBIGDC_PBOTZ960_body").innerHTML = ""
        document.getElementById("CBITDC_PBOTZ901_body").innerHTML = ""
        document.getElementById("CBITDC_PBOTZ902_body").innerHTML = ""
        document.getElementById("CBITDC_PBOTZ903_body").innerHTML = ""
        document.getElementById("CBITDC_PBOTZ904_body").innerHTML = ""
        document.getElementById("CBITDC_PBOTZ960_body").innerHTML = ""
        //date passed in?
        if(datePassedIn!=undefined && datePassedIn!=""){
            self.date = new Date(datePassedIn);
            date.setDate(date.getDate() + 1)
            self.hideAvailable = true;
        } else {
            self.hideAvailable = false;
            self.date = new Date();
        }
        //init date variables
        self.weekday = new Array(7);
        weekday[0] = "Sunday";weekday[1] = "Monday";weekday[2] = "Tuesday";weekday[3] = "Wednesday";weekday[4] = "Thursday"; weekday[5] = "Friday";weekday[6] = "Saturday";
        self.today = date.getDate();
        self.hour = date.getHours();
        self.day = weekday[date.getDay()];
        self.lastDayOfMonth = new Date(date.getFullYear(),date.getMonth()+1,0).getDate();
        self.businessDay = "";
        self.monthEndDay = "";
        self.TURNINGPOINT = 15;
        
        document.getElementById("todaysDate").innerHTML = date;
        // Print bots to screen
        printToScreen(CBIGDCxPBOTZ901, "CBIGDC_PBOTZ901");
        printToScreen(CBIGDCxPBOTZ902, "CBIGDC_PBOTZ902");
        printToScreen(CBIGDCxPBOTZ903, "CBIGDC_PBOTZ903");
        printToScreen(CBIGDCxPBOTZ904, "CBIGDC_PBOTZ904");
        printToScreen(CBIGDCxPBOTZ960, "CBIGDC_PBOTZ960");
        printToScreen(CBITDCxPBOTZ901, "CBITDC_PBOTZ901");
        printToScreen(CBITDCxPBOTZ902, "CBITDC_PBOTZ902");
        printToScreen(CBITDCxPBOTZ903, "CBITDC_PBOTZ903");
        printToScreen(CBITDCxPBOTZ904, "CBITDC_PBOTZ904");
        printToScreen(CBITDCxPBOTZ960, "CBITDC_PBOTZ960");
        //debug help 
        console.log("Today: " + today)
        console.log("Day of the week: " + day)
        console.log("Hour: " + hour)
        console.log("Business Day: " + businessDay)
        console.log("Month End Day: " + monthEndDay)
        isBusinessDay(self.date);
        document.getElementById("biz_day").innerHTML = self.biz_day;
        document.getElementById("day").innerHTML = day;
        if(!hideAvailable){ 
            document.getElementById("hour").innerHTML = moment(hour + ":00:00", 'HH:mm').format('h:mm A');
        } else {
            document.getElementById("hour").innerHTML = "N/A";
        }
        document.getElementById("businessDay").innerHTML = businessDay.replace("N","-").replace("day","Day ");
        document.getElementById("monthEnd").innerHTML = (monthEndDay.replace("N","-")).replace("MEday","Month End Day ");
        if((monthEndDay.replace("N","-")).replace("MEday","Month End Day ") === ""){
            document.getElementById("monthEnd").innerHTML = "N/A";
        }
    }
    /*
     * MODAL 
    */
    // Get the button that opens the modal
    var gdc1 = document.getElementById("CBIGDC_PBOTZ901_body");
    var gdc2 = document.getElementById("CBIGDC_PBOTZ902_body");
    var gdc3 = document.getElementById("CBIGDC_PBOTZ903_body");
    var gdc4 = document.getElementById("CBIGDC_PBOTZ904_body");
    var gdc5 = document.getElementById("CBIGDC_PBOTZ960_body");
    var tdc1 = document.getElementById("CBITDC_PBOTZ901_body");
    var tdc2 = document.getElementById("CBITDC_PBOTZ902_body");
    var tdc3 = document.getElementById("CBITDC_PBOTZ903_body");
    var tdc4 = document.getElementById("CBITDC_PBOTZ904_body");
    var tdc5 = document.getElementById("CBITDC_PBOTZ960_body");
    var help = document.getElementById("help");
    var botClicked = "";
    var modal = document.getElementById('modal');
    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];
    // When the user clicks the button, open the modal 
    gdc1.onclick = function() {self.color="#E0DA83";reserveBotTime(self.non_sched_hours01,CBIGDCxPBOTZ901,"CBIGDC_PBOTZ901",self.reservations01);self.bot_utilization = self.bot_utilization01;document.getElementById('schedule').innerHTML = "<a style='font-weight: initial;' target='_blank' href='schedules/bot01.html'>(Open Schedule)</a>"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<iframe class='sched' src='schedules/bot01.html'></iframe><div class='running_today_title'>Running Today:</div><span class='running_today_text'>"+self.gdc01_runningToday+"</span>";
        document.getElementById('bot_utilized_percent').innerHTML = "<div class='progress-bar progress-bar-striped' role='progressbar' style='width:"+self.bot_utilization+"; background-color:"+self.color+"'>Bot is <strong>" + self.bot_utilization + "</strong> Utilized</div>"}
    gdc2.onclick = function() {self.color="#fb9696";reserveBotTime(self.non_sched_hours02,CBIGDCxPBOTZ902,"CBIGDC_PBOTZ902",self.reservations02);self.bot_utilization = self.bot_utilization02;document.getElementById('schedule').innerHTML = "<a style='font-weight: initial;' target='_blank' href='schedules/bot02.html'>(Open Schedule)</a>"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<iframe class='sched' src='schedules/bot02.html'></iframe><div class='running_today_title'>Running Today:</div><span class='running_today_text'>"+self.gdc02_runningToday+"</span>";
        document.getElementById('bot_utilized_percent').innerHTML = "<div class='progress-bar progress-bar-striped' role='progressbar' style='width:"+self.bot_utilization+"; background-color:"+self.color+"'>Bot is <strong>" + self.bot_utilization + "</strong> Utilized</div>"}
    gdc3.onclick = function() {self.color="#79b8e5";reserveBotTime(self.non_sched_hours03,CBIGDCxPBOTZ903,"CBIGDC_PBOTZ903",self.reservations03);self.bot_utilization = self.bot_utilization03;document.getElementById('schedule').innerHTML = "<a style='font-weight: initial;' target='_blank' href='schedules/bot03.html'>(Open Schedule)</a>"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<iframe class='sched' src='schedules/bot03.html'></iframe><div class='running_today_title'>Running Today:</div><span class='running_today_text'>"+self.gdc03_runningToday+"</span>";
        document.getElementById('bot_utilized_percent').innerHTML = "<div class='progress-bar progress-bar-striped' role='progressbar' style='width:"+self.bot_utilization+"; background-color:"+self.color+"'>Bot is <strong>" + self.bot_utilization + "</strong> Utilized</div>"}
    gdc4.onclick = function() {self.color="#eda84f";reserveBotTime(self.non_sched_hours04,CBIGDCxPBOTZ904,"CBIGDC_PBOTZ904",self.reservations04);self.bot_utilization = self.bot_utilization04;document.getElementById('schedule').innerHTML = "<a style='font-weight: initial;' target='_blank' href='schedules/bot04.html'>(Open Schedule)</a>"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<iframe class='sched' src='schedules/bot04.html'></iframe><div class='running_today_title'>Running Today:</div><span class='running_today_text'>"+self.gdc04_runningToday+"</span>";
        document.getElementById('bot_utilized_percent').innerHTML = "<div class='progress-bar progress-bar-striped' role='progressbar' style='width:"+self.bot_utilization+"; background-color:"+self.color+"'>Bot is <strong>" + self.bot_utilization + "</strong> Utilized</div>"}
    gdc5.onclick = function() {self.color="#04d491";reserveBotTime(self.non_sched_hours05,CBIGDCxPBOTZ960,"CBIGDC_PBOTZ960",self.reservations05);self.bot_utilization = self.bot_utilization05; document.getElementById('schedule').innerHTML = "<a style='font-weight: initial;' target='_blank' href='schedules/bot05.html'>(Open Schedule)</a>"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<iframe class='sched' src='schedules/bot05.html'></iframe><div class='running_today_title'>Running Today:</div><span class='running_today_text'>"+self.gdc05_runningToday+"</span>";
        document.getElementById('bot_utilized_percent').innerHTML = "<div class='progress-bar progress-bar-striped' role='progressbar' style='width:"+self.bot_utilization+"; background-color:"+self.color+"'>Bot is <strong>" + self.bot_utilization + "</strong> Utilized</div>"}
    tdc1.onclick = function() {self.color="#8fc568";reserveBotTime(self.non_sched_hours06,CBITDCxPBOTZ901,"CBITDC_PBOTZ901",self.reservations06);self.bot_utilization = self.bot_utilization06;document.getElementById('schedule').innerHTML = "<a style='font-weight: initial;' target='_blank' href='schedules/bot06.html'>(Open Schedule)</a>"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<iframe class='sched' src='schedules/bot06.html'></iframe><div class='running_today_title'>Running Today:</div><span class='running_today_text'>"+self.tdc01_runningToday+"</span>";
        document.getElementById('bot_utilized_percent').innerHTML = "<div class='progress-bar progress-bar-striped' role='progressbar' style='width:"+self.bot_utilization+"; background-color:"+self.color+"'>Bot is <strong>" + self.bot_utilization + "</strong> Utilized</div>"}
    tdc2.onclick = function() {self.color="#6e7275";reserveBotTime(self.non_sched_hours07,CBITDCxPBOTZ902,"CBITDC_PBOTZ902",self.reservations07);self.bot_utilization = self.bot_utilization07;document.getElementById('schedule').innerHTML = "<a style='font-weight: initial;' target='_blank' href='schedules/bot07.html'>(Open Schedule)</a>"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<iframe class='sched' src='schedules/bot07.html'></iframe><div class='running_today_title'>Running Today:</div><span class='running_today_text'>"+self.tdc02_runningToday+"</span>";
        document.getElementById('bot_utilized_percent').innerHTML = "<div class='progress-bar progress-bar-striped' role='progressbar' style='width:"+self.bot_utilization+"; background-color:"+self.color+"'>Bot is <strong>" + self.bot_utilization + "</strong> Utilized</div>"}
    tdc3.onclick = function() {self.color="#b8c0c5";reserveBotTime(self.non_sched_hours08,CBITDCxPBOTZ903,"CBITDC_PBOTZ903",self.reservations08);self.bot_utilization = self.bot_utilization08;document.getElementById('schedule').innerHTML = "<a style='font-weight: initial;' target='_blank' href='schedules/bot08.html'>(Open Schedule)</a>"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<iframe class='sched' src='schedules/bot08.html'></iframe><div class='running_today_title'>Running Today:</div><span class='running_today_text'>"+self.tdc03_runningToday+"</span>";
        document.getElementById('bot_utilized_percent').innerHTML = "<div class='progress-bar progress-bar-striped' role='progressbar' style='width:"+self.bot_utilization+"; background-color:"+self.color+"'>Bot is <strong>" + self.bot_utilization + "</strong> Utilized</div>"}
    tdc4.onclick = function() {self.color="#2eaba7";reserveBotTime(self.non_sched_hours09,CBITDCxPBOTZ904,"CBITDC_PBOTZ904",self.reservations09);self.bot_utilization = self.bot_utilization09;document.getElementById('schedule').innerHTML = "<a style='font-weight: initial;' target='_blank' href='schedules/bot09.html'>(Open Schedule)</a>"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<iframe class='sched' src='schedules/bot09.html'></iframe><div class='running_today_title'>Running Today:</div><span class='running_today_text'>"+self.tdc04_runningToday+"</span>";
        document.getElementById('bot_utilized_percent').innerHTML = "<div class='progress-bar progress-bar-striped' role='progressbar' style='width:"+self.bot_utilization+"; background-color:"+self.color+"'>Bot is <strong>" + self.bot_utilization + "</strong> Utilized</div>"}
    tdc5.onclick = function() {self.color="#af95e2";reserveBotTime(self.non_sched_hours010,CBITDCxPBOTZ960,"CBITDC_PBOTZ960",self.reservations010);self.bot_utilization = self.bot_utilization010;document.getElementById('schedule').innerHTML = "<a style='font-weight: initial;' target='_blank' href='schedules/bot10.html'>(Open Schedule)</a>"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<iframe class='sched' src='schedules/bot10.html'></iframe><div class='running_today_title'>Running Today:</div><span class='running_today_text'>"+self.tdc05_runningToday+"</span>";
        document.getElementById('bot_utilized_percent').innerHTML = "<div class='progress-bar progress-bar-striped' role='progressbar' style='width:"+self.bot_utilization+"; background-color:"+self.color+"'>Bot is <strong>" + self.bot_utilization + "</strong> Utilized</div>"}
    help.onclick = function() {document.getElementById('utilization_bar').style.display = "none";document.getElementById('reserve_time_wrapper').style.display = "none";document.getElementById('schedule').innerHTML ="Help:"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<iframe src='imgs/help.pdf' style='height:600px'></iframe>"; document.getElementById('bot_utilized_percent').innerHTML ="";}
    //IFRAME Call on Port
    function bot_status_iframe_login(src) {
        if(src != 'FALSE'){
            document.getElementById('utilization_bar').style.display = "none";document.getElementById('reserve_time_wrapper').style.display = "none";document.getElementById('schedule').innerHTML ="Processes ran/running since last logout:"; document.getElementById('modal').style.display = "block"; document.getElementById('bot_utilized_percent').innerHTML ="";
        } else {
            document.getElementById('utilization_bar').style.display = "none";document.getElementById('reserve_time_wrapper').style.display = "none";document.getElementById('schedule').innerHTML ="<span style='letter-spacing:0'>Should read: 'AUTOMATE RESOURCE PC / LISTENER *'<br>If blank enable mixed content!<hr></span>"; document.getElementById('modal').style.display = "block"; document.getElementById('bot_utilized_percent').innerHTML =""; 
        }
        self.src = src;
        self.uname = localStorage.getItem('cwc_iframe_bp_uname');
        self.pword = localStorage.getItem('cwc_iframe_bp_pword');
        if (self.uname === null || self.pword === null) {
            document.getElementById('bot_picture').innerHTML = 
            "<form name='loginform' onsubmit='return false' class='form-group'><input name='uname' placeholder='username' type='text'><br><input name='pword' placeholder='password' type='password' style='margin-top:2px;'><br><button style='margin-top:2px;'class='btn-primary btn btn-sm' onclick='bot_status_iframe()' type='submit'>Get Status</button></form>" +
            "<hr><strong>Login Help:</strong>" +
            "<div style='font-family:monospace'>Login using CBI credentials." +
            "<br>Enable MixedContent - <br><a href='https://support.mozilla.org/en-US/kb/mixed-content-blocking-firefox'>In FireFox</a>" +
            "<br><a href='https://kb.iu.edu/d/bdny'>In Chrome</a></div>"
        } else {
            bot_status_iframe();
        }
        document.getElementsByClassName("close")[0].onclick = function() {
            document.getElementById('modal').style.display = "none";
        }
        window.onclick = function(event) {
            if (event.target == document.getElementById('modal')) {
                document.getElementById('modal').style.display = "none";
            }
        }
    }
    function bot_status_iframe() {
        if(document.forms.loginform != undefined){
            self.uname = document.forms["loginform"]["uname"].value;
            self.pword = document.forms["loginform"]["pword"].value;
        }
        if(localStorage.getItem('cwc_iframe_bp_uname') !== null){
            self.uname = localStorage.getItem('cwc_iframe_bp_uname');
        } else {
            localStorage.setItem('cwc_iframe_bp_uname',self.uname);
        }
        if(localStorage.getItem('cwc_iframe_bp_pword') !== null){
            self.pword = localStorage.getItem('cwc_iframe_bp_pword');
        } else {
            localStorage.setItem('cwc_iframe_bp_pword',self.pword);
        }
        if(self.src != 'FALSE'){
            self.src = self.src.replace("username",self.uname)
            self.src = self.src.replace("pwd",self.pword)
            document.getElementById('bot_picture').innerHTML = "<button style='margin-top:2px;'class='btn-default btn btn-sm' onclick='clear_login_data()'>Logout</button><hr><iframe src='"+src+"' style='height:600px'></iframe>"; 
        } else {
            document.getElementById('bot_picture').innerHTML = "<button style='margin-top:2px;'class='btn-default btn btn-sm' onclick='clear_login_data()'>Logout</button><hr>"; 
            document.getElementById('bot_picture').innerHTML += "GDC901:<iframe src='http://cbigdc-pbotz901.cbi.net:8181/version'></iframe>"
            document.getElementById('bot_picture').innerHTML += "GDC902:<iframe src='http://cbigdc-pbotz902.cbi.net:8181/version'></iframe>"
            document.getElementById('bot_picture').innerHTML += "GDC903:<iframe src='http://cbigdc-pbotz903.cbi.net:8181/version'></iframe>"
            document.getElementById('bot_picture').innerHTML += "GDC904:<iframe src='http://cbigdc-pbotz904.cbi.net:8181/version'></iframe>"
            document.getElementById('bot_picture').innerHTML += "GDC960:<iframe src='http://cbigdc-pbotz960.cbi.net:8181/version'></iframe>"
            document.getElementById('bot_picture').innerHTML += "TDC901:<iframe src='http://cbitdc-pbotz901.cbi.net:8181/version'></iframe>"
            document.getElementById('bot_picture').innerHTML += "TDC902:<iframe src='http://cbitdc-pbotz902.cbi.net:8181/version'></iframe>"
            document.getElementById('bot_picture').innerHTML += "TDC903:<iframe src='http://cbitdc-pbotz903.cbi.net:8181/version'></iframe>"
            document.getElementById('bot_picture').innerHTML += "TDC904:<iframe src='http://cbitdc-pbotz904.cbi.net:8181/version'></iframe>"
            document.getElementById('bot_picture').innerHTML += "TDC960:<iframe src='http://cbitdc-pbotz960.cbi.net:8181/version'></iframe>"
        }
    }
    function clear_login_data(){
        localStorage.clear();
        document.getElementById('modal').style.display = "none";
    }
    
    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
        document.getElementById('modal').style.display = "none";
    }
    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
        if (event.target == modal) {
            document.getElementById('modal').style.display = "none";
        }
    }
    function openNav() {
        document.getElementById("mySidebar").style.width = "250px";
        document.getElementById("main").style.display = "none";
        document.getElementById("mySidebar").style.borderRight = "1px solid goldenrod";
    }
    function closeNav() {
        document.getElementById("mySidebar").style.width = "0";
        document.getElementById("mySidebar").style.borderRight = "1px solid black";
        document.getElementById("main").style.marginLeft= "0";
        document.getElementById("main").style.display = "block";
    }
    // Refresh page every hour 
    setInterval(function() {
                  window.location.reload();
    }, ((60 - date.getMinutes())*60)*1000); 
    function reserveBotTime(non_sched_hours,bot,bot_name,reservations){
        self.non_sched_hours = non_sched_hours;
        self.bot = bot;
        self.bot_name = bot_name;
        document.getElementById('reserve_time_wrapper').style.display = "block";
        document.getElementById('utilization_bar').style.display = "block";
        document.getElementById('missing_info_error').innerHTML = "";

        if(reservations!=undefined && reservations.length > 0){
            document.getElementById('reserved_times').innerHTML = reservations.toString().replace(/,/g,"<button class='delete_btns btn btn-danger btn-xs'>Delete</button><br>");
            document.getElementById('reserved_times').innerHTML = document.getElementById('reserved_times').innerHTML + "<button class='delete_btns btn btn-danger btn-xs'>Delete</button>";
        } else {
            document.getElementById('reserved_times').innerHTML = "";
        }
        if(non_sched_hours === undefined){
            non_sched_hours=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23];
            for(var time in non_sched_hours){ non_sched_hours[time] = moment(non_sched_hours[time] + ":00:00", 'HH:mm').format('hh:mm A');}
            document.getElementById('reserve_bot_time').innerHTML = "<button style='background-color:"+self.color+";border:1px solid "+self.color+"' class='non_sched_btns btn btn-success btn-xs'>"+non_sched_hours.toString().replace(/,/g,"<button style='background-color:"+self.color+";border:1px solid "+self.color+"' class='non_sched_btns btn btn-success btn-xs'>")+"</button>";
        }
        else if(non_sched_hours.length < 1) {
            document.getElementById('reserve_bot_time').innerHTML = "No time slots to reserve";
        }
        else if(typeof non_sched_hours[0] === 'string' || non_sched_hours[0] instanceof String){
            for(var time in self.non_sched_hours){ self.non_sched_hours[time] = Number(moment(self.non_sched_hours[time],"h:mm A").format("H"));}
            for(var time in non_sched_hours){ non_sched_hours[time] = moment(non_sched_hours[time] + ":00:00", 'HH:mm').format('hh:mm A');}
            document.getElementById('reserve_bot_time').innerHTML = "<button style='background-color:"+self.color+";border:1px solid "+self.color+"' class='non_sched_btns btn btn-success btn-xs'>"+non_sched_hours.toString().replace(/,/g,"<button style='background-color:"+self.color+";border:1px solid "+self.color+"' class='non_sched_btns btn btn-success btn-xs'>")+"</button>";
        }
        else { 
            for(var time in non_sched_hours){ non_sched_hours[time] = moment(non_sched_hours[time] + ":00:00", 'HH:mm').format('hh:mm A');}
            document.getElementById('reserve_bot_time').innerHTML = "<button style='background-color:"+self.color+";border:1px solid "+self.color+"' class='non_sched_btns btn btn-success btn-xs'>"+non_sched_hours.toString().replace(/,/g,"<button style='background-color:"+self.color+";border:1px solid "+self.color+"' class='non_sched_btns btn btn-success btn-xs'>")+"</button>";
        }
        var buttons = document.querySelectorAll('.' + 'non_sched_btns');
        for (var i=0 ; i < buttons.length ; i++){
            (function(index){
                buttons[index].onclick = function(){
                    var reserve_name = document.getElementById('reserve_name').value;
                    var reserve_process = document.getElementById('reserve_process').value;
                    if(reserve_process != "" && reserve_name != ""){
                        document.getElementById('reserve_bot_time').innerHTML = "reserving please wait..."
                        if(self.non_sched_hours===undefined){
                            self.non_sched_hours = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23];
                        }
                        if(self.bot.reserved===undefined){
                            self.bot.reserved = [self.non_sched_hours[index]];
                        } else {
                            self.bot.reserved.push(self.non_sched_hours[index]);
                        }
                        for(var time in self.bot.reserved){self.bot.reserved[time] = Number(moment(self.bot.reserved[time],"h:mm A").format("H"));}
                        sendReserveAPI(self.bot.reserved, self.bot_name, reserve_name, reserve_process);
                    } else {
                        document.getElementById('missing_info_error').innerHTML = "*Enter your name and process name";
                    }
                };
            })(i)
        }
        var dlt_buttons = document.querySelectorAll('.' + 'delete_btns');
        var text = '';
        var ID = '';
        for (var i=0 ; i < dlt_buttons.length ; i++){
            (function(index){
                dlt_buttons[index].onclick = function(text){
                    text.currentTarget.innerText = "Deleting..."
                    text = text.currentTarget.previousSibling.data;
                    ID = text.substring(text.lastIndexOf("(") + 1, text.lastIndexOf(")"));
                    deleteReserveAPI(ID);
                };
            })(i)
        }
    }
    
    function sendReserveAPI(reservedTimes,bot_name,reserve_name,reserve_process){
        //API DB 
        var jsondata = {[bot_name]: reservedTimes, "name":reserve_name, "process":reserve_process};
       
        var settings = {
            "async": true,
            "crossDomain": true,
            "url": "https://rpaapi-e0b7.restdb.io/rest/bots/5cdd56c63b66915f6881f8ac",
            "method": "POST",
            "headers": {
                "content-type": "application/json",
                "x-apikey": "5cdd56c63b66915f6881f8ac",
                "cache-control": "no-cache"
            },
            "processData": false,
            "data": JSON.stringify(jsondata)
        }
        $.ajax(settings).done(function (response) {
            window.location.reload();
        });
    }
    
    function getReserveAPI(){
        var settings = {
            "async": false,
            "crossDomain": true,
            "url": "https://rpaapi-e0b7.restdb.io/rest/bots",
            "method": "GET",
            "headers": {
                "content-type": "application/json",
                "x-apikey": "5cdd56c63b66915f6881f8ac",
                "cache-control": "no-cache"
            }
        }
                        
        $.ajax(settings).done(function (response) {
            self.RESERVE_DATA = response;
            console.log(response)
        });   
    }

    function deleteReserveAPI(id){
        var settings = {
            "async": true,
            "crossDomain": true,
            "url": "https://rpaapi-e0b7.restdb.io/rest/bots/"+id,
            "method": "DELETE",
            "headers": {
                "content-type": "application/json",
                "x-apikey": "5cdd56c63b66915f6881f8ac",
                "cache-control": "no-cache"
            }
        }

        $.ajax(settings).done(function (response) {
            window.location.reload();
        });
    }

</script>

	<!--[if IE]>
		<center><strong>Program does not work in Internet Explorer. Please use Chrome or Firefox.</strong><br>Thank you!<center>
	<![endif]--> 

</body>
</html>