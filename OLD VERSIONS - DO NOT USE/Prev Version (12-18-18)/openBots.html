<!DOCTYPE html> 
<head>
    <meta charset="UTF-8">
    <meta name="author" content="Ben Bobo">
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="imgs/favicon.png">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="js/openBotsSchedule.js"></script>
    <script src="js/isBusinessDay.js"></script>
    <script src="js/printToScreen.js"></script>
    <script src="js/convertToBusinessDay.js"></script>
    <script src="js/convertDayToMonthEndDay.js"></script>
</head>
<html>
<body>
<![if !IE]>
<!-- The Modal #HTML-->
<div id="modal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <p id="schedule"></p>
    <div id="bot_picture" style="width:100%"></div>
  </div>
</div>

<!-- The Header #HTML-->
<ul class="headerMobile">
    <li class="media_small">
        <a href="http://dms.cbrands.com/confluence/display/RPA/Blue+Prism+-+Scheduling" target="_blank" class="header_link">Todays Bot Schedule: 
        <p class="header_todays_date" id="todaysDate"></p></a>
    </li>
    <li class="media_small"><a class="active">v2.3</a></li>
    <li class="header"><a class="active"> 
        <div class="material-icons header_change_date refresh_date" onClick="window.location.reload()">&#xe5d5;</div>
        <div class="change_date_title">Change Date:</div>
        <input type="date" id="dateInput" class="header_date_selector">
        <div type="submit" onclick="init(document.getElementById('dateInput').value)" class="material-icons header_change_date">&#xe8b6;</div></a>
    </li>
</ul>

<!-- The Mobile Header #HTML-->
<div id="myNav" class="overlay mobileNav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <div class="overlay-content">
        <a class="footer_id" id="dayMobile"></a> <a></a>
        <a class="footer_id" id="hourMobile"></a> <a></a>
        <a class="footer_id" id="businessDayMobile"></a> <a></a>
        <a class="footer_id" id="monthEndMobile"></a> <a></a>
        <a class="found_bug" href="mailto:ben.bobo@cbrands.com?subject=Open Bots Bug&body=Description of Bug/Error: "> Something Broken? <i style="font-size:18px;" class="material-icons">&#xe0be;</i></a>
    </div>
  </div>
  <span class="mobileNav navBtn" onclick="openNav()">MENU</span>

<!--***********************************START BOTS PRINTED SCHEDULES #HTML************************************-->
<center>
    <h5 style="margin-top:10px" class="mobileTime"> (All times below are EST) </h5>

    <div><h2 class="bots_server_title">GDC Bots</h2></div>
    <!--CBIGDC_PBOTZ901-->
    <div id="GDC_PBOTZ901" class="hover bot_container">
        <p title="CBIGDC_PBOTZ901" id="CBIGDC_PBOTZ901_title" class="bot_title" style="background-color:#f2f774"></p>
        <p id="CBIGDC_PBOTZ901_body"  class="bot_body"></p>
        <div id="CBIGDC_PBOTZ901_resourceUnit"><iframe scrolling="no" src="http://cbigdc-pbotz901.cbi.net:8181/status"></iframe></div>
        <p id="CBIGDC_PBOTZ901_available" class="bot_available"></p>
        <p id="CBIGDC_PBOTZ901_dupe" class="bot_dupe"></p>
    </div>
    <!--CBIGDC_PBOTZ902-->
    <div id="GDC_PBOTZ902" class="hover bot_container">
        <p title="CBIGDC_PBOTZ902" id="CBIGDC_PBOTZ902_title" class="bot_title" style="background-color:#fc8a8a"></p>
        <p id="CBIGDC_PBOTZ902_body" class="bot_body"></p>
        <div id="CBIGDC_PBOTZ902_resourceUnit"><iframe scrolling="no" src="http://cbigdc-pbotz902.cbi.net:8181/status"></iframe></div> 
        <p id="CBIGDC_PBOTZ902_available" class="bot_available"></p>
        <p id="CBIGDC_PBOTZ902_dupe" class="bot_dupe"></p>
    </div>
    <!--CBIGDC_PBOTZ903-->
    <div id="GDC_PBOTZ903" class="hover bot_container">
        <p title="CBIGDC_PBOTZ903" id="CBIGDC_PBOTZ903_title" class="bot_title" style="background-color:#79b8e5"></p>
        <p id="CBIGDC_PBOTZ903_body" class="bot_body"></p>
        <div id="CBIGDC_PBOTZ903_resourceUnit"><iframe scrolling="no" src="http://cbigdc-pbotz903.cbi.net:8181/status"></iframe></div> 
        <p id="CBIGDC_PBOTZ903_available" class="bot_available"></p>
        <p id="CBIGDC_PBOTZ903_dupe" class="bot_dupe"></p>
    </div>
    <!--CBIGDC_PBOTZ904-->
    <div id="GDC_PBOTZ904" class="hover bot_container">
        <p title="CBIGDC_PBOTZ904" id="CBIGDC_PBOTZ904_title" class="bot_title" style="background-color:#f4bf7a"></p>
        <p id="CBIGDC_PBOTZ904_body" class="bot_body"></p>
        <div id="CBIGDC_PBOTZ904_resourceUnit"><iframe scrolling="no" src="http://cbigdc-pbotz904.cbi.net:8181/status"></iframe></div> 
        <p id="CBIGDC_PBOTZ904_available" class="bot_available"></p>
        <p id="CBIGDC_PBOTZ904_dupe" class="bot_dupe"></p>
    </div><br>
    <div><h2 class="bots_server_title" style="margin-top:40px;">TDC Bots</h2></div>
    <!--CBITDC_PBOTZ901-->
    <div id="TDC_PBOTZ901" class="hover bot_container">
        <p title="CBITDC_PBOTZ901" id="CBITDC_PBOTZ901_title" class="bot_title" style="background-color:#a2dd77"></p>
        <p id="CBITDC_PBOTZ901_body" class="bot_body"></p>
        <div id="CBITDC_PBOTZ901_resourceUnit"><iframe scrolling="no" src="http://cbitdc-pbotz901.cbi.net:8181/status"></iframe></div> 
        <p id="CBITDC_PBOTZ901_available" class="bot_available"></p>
        <p id="CBITDC_PBOTZ901_dupe" class="bot_dupe"></p>
    </div>
    <!--CBITDC_PBOTZ902-->
    <div id="TDC_PBOTZ902" class="hover bot_container">
        <p title="CBITDC_PBOTZ902" id="CBITDC_PBOTZ902_title" class="bot_title" style="background-color:#d2d7db"></p>
        <p id="CBITDC_PBOTZ902_body" class="bot_body"></p>
        <div id="CBITDC_PBOTZ902_resourceUnit"><iframe id="tdc-pbotz902" scrolling="no" src="http://cbitdc-pbotz902.cbi.net:8181/status"></iframe></div>
        <p id="CBITDC_PBOTZ902_available" class="bot_available"></p>
        <p id="CBITDC_PBOTZ902_dupe" class="bot_dupe"></p>
    </div>
    <!--CBITDC_PBOTZ903-->
    <div id="TDC_PBOTZ903" class="hover bot_container">
        <p title="CBITDC_PBOTZ903" id="CBITDC_PBOTZ903_title" class="bot_title" style="background-color:#edf0f2"></p>
        <p id="CBITDC_PBOTZ903_body" class="bot_body"></p>
        <div id="CBITDC_PBOTZ903_resourceUnit"><iframe scrolling="no" src="http://cbitdc-pbotz903.cbi.net:8181/status"></iframe></div>
        <p id="CBITDC_PBOTZ903_available" class="bot_available"></p>
        <p id="CBITDC_PBOTZ903_dupe" class="bot_dupe"></p>
    </div>
    <!--CBITDC_PBOTZ904-->
    <div id="TDC_PBOTZ904" class="hover bot_container">
        <p title="CBITDC_PBOTZ904" id="CBITDC_PBOTZ904_title" class="bot_title" style="background-color:#d4fcfb"></p>
        <p id="CBITDC_PBOTZ904_body" class="bot_body"></p>
        <div id="CBITDC_PBOTZ904_resourceUnit"><iframe scrolling="no" src="http://cbitdc-pbotz904.cbi.net:8181/status"></iframe></div> 
        <p id="CBITDC_PBOTZ904_available" class="bot_available"></p>
        <p id="CBITDC_PBOTZ904_dupe" class="bot_dupe"></p>
    </div>
</center>
<!--***********************************END BOTS PRINTED SCHEDULES #HTML************************************-->
<![endif]>

<div class="footer_container"></div>
<footer class="footer">
    <div class="footer_box media_small">
        <div class="footer_id" id="day"></div>
        <div class="footer_id" id="hour"></div>
        <div class="footer_id" id="businessDay"></div>
        <div class="footer_id" id="monthEnd"></div> 
    </div>
    <a class="found_bug" href="mailto:ben.bobo@cbrands.com?subject=Open Bots Bug&body=Description of Bug/Error: "> Something Broken? <i style="font-size:18px;" class="material-icons">&#xe0be;</i>
</a>
</footer>
<div class="help">
    <i id="help" class="material-icons">&#xe8fd;</i>
</div>

<script>
    var self = this;
    init();

    function init(datePassedIn){
        self.botSched();
        //reset printed schedules 
        document.getElementById("CBIGDC_PBOTZ901_body").innerHTML = ""
        document.getElementById("CBIGDC_PBOTZ902_body").innerHTML = ""
        document.getElementById("CBIGDC_PBOTZ903_body").innerHTML = ""
		document.getElementById("CBIGDC_PBOTZ904_body").innerHTML = ""
        document.getElementById("CBITDC_PBOTZ901_body").innerHTML = ""
        document.getElementById("CBITDC_PBOTZ902_body").innerHTML = ""
        document.getElementById("CBITDC_PBOTZ903_body").innerHTML = ""
		document.getElementById("CBITDC_PBOTZ904_body").innerHTML = ""

        //date passed in?
        if(datePassedIn!=undefined && datePassedIn!=""){
            self.date = new Date(datePassedIn);
            date.setDate(date.getDate() + 1)
            self.hideAvailable = true;
        } else {
            self.hideAvailable = false;
            self.date = new Date();
        }

        //init date variables
        self.weekday = new Array(7);
        weekday[0] = "Sunday";weekday[1] = "Monday";weekday[2] = "Tuesday";weekday[3] = "Wednesday";weekday[4] = "Thursday"; weekday[5] = "Friday";weekday[6] = "Saturday";
        self.today = date.getDate();
        self.hour = date.getHours();
        self.day = weekday[date.getDay()];
        self.lastDayOfMonth = new Date(date.getFullYear(),date.getMonth()+1,0).getDate();
        self.businessDay = "";
        self.monthEndDay = "";
        self.TURNINGPOINT = 15;
        
        document.getElementById("todaysDate").innerHTML = date;

        // Print bots to screen
        printToScreen(CBIGDCxPBOTZ901, "CBIGDC_PBOTZ901");
        printToScreen(CBIGDCxPBOTZ902, "CBIGDC_PBOTZ902");
        printToScreen(CBIGDCxPBOTZ903, "CBIGDC_PBOTZ903");
		printToScreen(CBIGDCxPBOTZ904, "CBIGDC_PBOTZ904");
        printToScreen(CBITDCxPBOTZ901, "CBITDC_PBOTZ901");
        printToScreen(CBITDCxPBOTZ902, "CBITDC_PBOTZ902");
        printToScreen(CBITDCxPBOTZ903, "CBITDC_PBOTZ903");
		printToScreen(CBITDCxPBOTZ904, "CBITDC_PBOTZ904");

        //debug help 
        console.log("Today: " + today)
        console.log("Day of the week: " + day)
        console.log("Hour: " + hour)
        console.log("Business Day: " + businessDay)
        console.log("Month End Day: " + monthEndDay)
        document.getElementById("day").innerHTML = day;
        document.getElementById("dayMobile").innerHTML = day;
        if(!hideAvailable){ 
            document.getElementById("hour").innerHTML = moment(hour + ":00:00", 'HH:mm').format('h:mm A');
            document.getElementById("hourMobile").innerHTML = moment(hour + ":00:00", 'HH:mm').format('h:mm A');
        } else {
            document.getElementById("hour").innerHTML = "N/A";
            document.getElementById("hourMobile").innerHTML = "N/A";
        }
        document.getElementById("businessDay").innerHTML = businessDay.replace("N","-").replace("day","Day ");;
        document.getElementById("businessDayMobile").innerHTML = businessDay.replace("N","-").replace("day","Day ");;
        document.getElementById("monthEnd").innerHTML = (monthEndDay.replace("N","-")).replace("MEday","Month End Day ");
        document.getElementById("monthEndMobile").innerHTML = (monthEndDay.replace("N","-")).replace("MEday","Month End Day ");
        if((monthEndDay.replace("N","-")).replace("MEday","Month End Day ") === ""){
            document.getElementById("monthEnd").innerHTML = "N/A";
            document.getElementById("monthEndMobile").innerHTML = "N/A";
        }
    }

    /*
     * MODAL 
    */
    // Get the button that opens the modal
    var gdc1 = document.getElementById("GDC_PBOTZ901");
    var gdc2 = document.getElementById("GDC_PBOTZ902");
    var gdc3 = document.getElementById("GDC_PBOTZ903");
    var gdc4 = document.getElementById("GDC_PBOTZ904");
    var tdc1 = document.getElementById("TDC_PBOTZ901");
    var tdc2 = document.getElementById("TDC_PBOTZ902");
    var tdc3 = document.getElementById("TDC_PBOTZ903");
    var tdc4 = document.getElementById("TDC_PBOTZ904");
    var help = document.getElementById("help");
    var botClicked = "";

    var modal = document.getElementById('modal');
    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];

    // When the user clicks the button, open the modal 
    gdc1.onclick = function() { document.getElementById('schedule').innerHTML = "Schedule (" + gdc1.id + "):"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<img src='imgs/gdcbot1.png' style='width:100%;border: 2px solid #888;'> <iframe class='stetch_iframe' scrolling='yes' src='http://cbigdc-pbotz901.cbi.net:8181/status'></iframe>";}
    gdc2.onclick = function() { document.getElementById('schedule').innerHTML = "Schedule (" + gdc2.id + "):"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<img src='imgs/gdcbot2.png' style='width:100%;border: 2px solid #888;'> <iframe class='stetch_iframe' scrolling='yes' src='http://cbigdc-pbotz902.cbi.net:8181/status'></iframe>";}
    gdc3.onclick = function() { document.getElementById('schedule').innerHTML = "Schedule (" + gdc3.id + "):"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<img src='imgs/gdcbot3.png' style='width:100%;border: 2px solid #888;'> <iframe class='stetch_iframe' scrolling='yes' src='http://cbigdc-pbotz903.cbi.net:8181/status'></iframe>";}
    gdc4.onclick = function() { document.getElementById('schedule').innerHTML = "Schedule (" + gdc4.id + "):"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<img src='imgs/gdcbot4.png' style='width:100%;border: 2px solid #888;'> <iframe class='stetch_iframe' scrolling='yes' src='http://cbigdc-pbotz904.cbi.net:8181/status'></iframe>";}
    tdc1.onclick = function() { document.getElementById('schedule').innerHTML = "Schedule (" + tdc1.id + "):"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<img src='imgs/tdcbot1.png' style='width:100%;border: 2px solid #888;'> <iframe class='stetch_iframe' scrolling='yes' src='http://cbitdc-pbotz901.cbi.net:8181/status'></iframe>";}
    tdc2.onclick = function() { document.getElementById('schedule').innerHTML = "Schedule (" + tdc2.id + "):"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<img src='imgs/tdcbot2.png' style='width:100%;border: 2px solid #888;'> <iframe class='stetch_iframe' scrolling='yes' src='http://cbitdc-pbotz902.cbi.net:8181/status'></iframe>";}
    tdc3.onclick = function() { document.getElementById('schedule').innerHTML = "Schedule (" + tdc3.id + "):"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<img src='imgs/tdcbot3.png' style='width:100%;border: 2px solid #888;'> <iframe class='stetch_iframe' scrolling='yes' src='http://cbitdc-pbotz903.cbi.net:8181/status'></iframe>";}
    tdc4.onclick = function() { document.getElementById('schedule').innerHTML = "Schedule (" + tdc4.id + "):"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<img src='imgs/tdcbot4.png' style='width:100%;border: 2px solid #888;'> <iframe class='stetch_iframe' scrolling='yes' src='http://cbitdc-pbotz904.cbi.net:8181/status'></iframe>";}
    help.onclick = function() { document.getElementById('schedule').innerHTML ="Help:"; modal.style.display = "block"; document.getElementById('bot_picture').innerHTML = "<iframe src='imgs/help.pdf' style='height:600px'></iframe>";}

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
        modal.style.display = "none";
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }

    // Mobile Nav Bar
    function openNav() {
        document.getElementById("myNav").style.height = "100%";
    }
    function closeNav() {
        document.getElementById("myNav").style.height = "0%";
    }

    // Refresh page every hour 
    setInterval(function() {
                  window.location.reload();
    }, ((60 - date.getMinutes())*60)*1000); 

</script>

	<!--[if IE]>
		<center><strong>Program does not work in Internet Explorer. Please use Chrome or Firefox.</strong><br>Thank you!<center>
	<![endif]--> 

</body>
</html>